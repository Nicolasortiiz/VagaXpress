{"architecture":"amd64","config":{"ExposedPorts":{"6379/tcp":{}},"Env":["PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin","REDIS_DOWNLOAD_URL=https://github.com/redis/redis/archive/refs/tags/8.0.2.tar.gz","REDIS_DOWNLOAD_SHA=caf3c0069f06fc84c5153bd2a348b204c578de80490c73857bee01d9b5d7401f"],"Entrypoint":["docker-entrypoint.sh"],"Cmd":["redis-server"],"Volumes":{"/data":{}},"WorkingDir":"/data"},"created":"2025-05-29T16:02:07Z","history":[{"created":"2025-05-20T00:00:00Z","created_by":"# debian.sh --arch 'amd64' out/ 'bookworm' '@1747699200'","comment":"debuerreotype 0.15"},{"created":"2025-05-29T16:02:07Z","created_by":"RUN /bin/sh -c set -eux; \tgroupadd -r -g 999 redis; \tuseradd -r -g redis -u 999 redis # buildkit","comment":"buildkit.dockerfile.v0"},{"created":"2025-05-29T16:02:07Z","created_by":"RUN /bin/sh -c set -eux; \tapt-get update; \tapt-get install -y --no-install-recommends \t\ttzdata \t; \trm -rf /var/lib/apt/lists/* # buildkit","comment":"buildkit.dockerfile.v0"},{"created":"2025-05-29T16:02:07Z","created_by":"ENV REDIS_DOWNLOAD_URL=https://github.com/redis/redis/archive/refs/tags/8.0.2.tar.gz","comment":"buildkit.dockerfile.v0","empty_layer":true},{"created":"2025-05-29T16:02:07Z","created_by":"ENV REDIS_DOWNLOAD_SHA=caf3c0069f06fc84c5153bd2a348b204c578de80490c73857bee01d9b5d7401f","comment":"buildkit.dockerfile.v0","empty_layer":true},{"created":"2025-05-29T16:02:07Z","created_by":"RUN /bin/sh -c set -eux; \t\tsavedAptMark=\"$(apt-mark showmanual)\"; \tapt-get update; \tapt-get install -y --no-install-recommends \t\tca-certificates \t\twget \t\tdpkg-dev \t\tgcc \t\tg++ \t\tlibc6-dev \t\tlibssl-dev \t\tmake; \t\tarch=\"$(dpkg --print-architecture | awk -F- '{ print $NF }')\"; \tcase \"$arch\" in \t\t'amd64') export BUILD_WITH_MODULES=yes; export INSTALL_RUST_TOOLCHAIN=yes; export DISABLE_WERRORS=yes ;; \t\t'arm64') export BUILD_WITH_MODULES=yes; export INSTALL_RUST_TOOLCHAIN=yes; export DISABLE_WERRORS=yes ;; \t\t*) echo \u003e\u00262 \"Modules are NOT supported! unsupported architecture: '$arch'\"; export BUILD_WITH_MODULES=no ;; \tesac; \tif [ \"$BUILD_WITH_MODULES\" = \"yes\" ]; then \t\tapt-get install -y --no-install-recommends \t\t\tgit \t\t\tcmake \t\t\tpython3 \t\t\tpython3-pip \t\t\tpython3-venv \t\t\tpython3-dev \t\t\tunzip \t\t\trsync \t\t\tclang \t\t\tautomake \t\t\tautoconf \t\t\tlibtool \t\t\tg++; \tfi; \t\trm -rf /var/lib/apt/lists/*; \t\twget -O redis.tar.gz \"$REDIS_DOWNLOAD_URL\"; \techo \"$REDIS_DOWNLOAD_SHA *redis.tar.gz\" | sha256sum -c -; \tmkdir -p /usr/src/redis; \ttar -xzf redis.tar.gz -C /usr/src/redis --strip-components=1; \trm redis.tar.gz; \t\tgrep -E '^ *createBoolConfig[(]\"protected-mode\",.*, *1 *,.*[)],$' /usr/src/redis/src/config.c; \tsed -ri 's!^( *createBoolConfig[(]\"protected-mode\",.*, *)1( *,.*[)],)$!\\10\\2!' /usr/src/redis/src/config.c; \tgrep -E '^ *createBoolConfig[(]\"protected-mode\",.*, *0 *,.*[)],$' /usr/src/redis/src/config.c; \t\tgnuArch=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\"; \textraJemallocConfigureFlags=\"--build=$gnuArch\"; \tcase \"${arch##*-}\" in \t\tamd64 | i386 | x32) extraJemallocConfigureFlags=\"$extraJemallocConfigureFlags --with-lg-page=12\" ;; \t\t*) extraJemallocConfigureFlags=\"$extraJemallocConfigureFlags --with-lg-page=16\" ;; \tesac; \textraJemallocConfigureFlags=\"$extraJemallocConfigureFlags --with-lg-hugepage=21\"; \tgrep -F 'cd jemalloc \u0026\u0026 ./configure ' /usr/src/redis/deps/Makefile; \tsed -ri 's!cd jemalloc \u0026\u0026 ./configure !\u0026'\"$extraJemallocConfigureFlags\"' !' /usr/src/redis/deps/Makefile; \tgrep -F \"cd jemalloc \u0026\u0026 ./configure $extraJemallocConfigureFlags \" /usr/src/redis/deps/Makefile; \t\texport BUILD_TLS=yes; \tmake -C /usr/src/redis -j \"$(nproc)\" all; \tmake -C /usr/src/redis install; \t\tserverMd5=\"$(md5sum /usr/local/bin/redis-server | cut -d' ' -f1)\"; export serverMd5; \tfind /usr/local/bin/redis* -maxdepth 0 \t\t-type f -not -name redis-server \t\t-exec sh -eux -c ' \t\t\tmd5=\"$(md5sum \"$1\" | cut -d\" \" -f1)\"; \t\t\ttest \"$md5\" = \"$serverMd5\"; \t\t' -- '{}' ';' \t\t-exec ln -svfT 'redis-server' '{}' ';' \t; \t\tmake -C /usr/src/redis distclean; \trm -r /usr/src/redis; \t\tapt-mark auto '.*' \u003e /dev/null; \t[ -z \"$savedAptMark\" ] || apt-mark manual $savedAptMark \u003e /dev/null; \tfind /usr/local -type f -executable -exec ldd '{}' ';' \t\t| awk '/=\u003e/ { so = $(NF-1); if (index(so, \"/usr/local/\") == 1) { next }; gsub(\"^/(usr/)?\", \"\", so); printf \"*%s\\n\", so }' \t\t| sort -u \t\t| xargs -r dpkg-query --search \t\t| cut -d: -f1 \t\t| sort -u \t\t| xargs -r apt-mark manual \t; \tapt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false; \trm -rf /var/cache/debconf/*; \t\tredis-cli --version; \tredis-server --version # buildkit","comment":"buildkit.dockerfile.v0"},{"created":"2025-05-29T16:02:07Z","created_by":"RUN /bin/sh -c mkdir /data \u0026\u0026 chown redis:redis /data # buildkit","comment":"buildkit.dockerfile.v0"},{"created":"2025-05-29T16:02:07Z","created_by":"VOLUME [/data]","comment":"buildkit.dockerfile.v0","empty_layer":true},{"created":"2025-05-29T16:02:07Z","created_by":"WORKDIR /data","comment":"buildkit.dockerfile.v0"},{"created":"2025-05-29T16:02:07Z","created_by":"COPY docker-entrypoint.sh /usr/local/bin/ # buildkit","comment":"buildkit.dockerfile.v0"},{"created":"2025-05-29T16:02:07Z","created_by":"ENTRYPOINT [\"docker-entrypoint.sh\"]","comment":"buildkit.dockerfile.v0","empty_layer":true},{"created":"2025-05-29T16:02:07Z","created_by":"EXPOSE map[6379/tcp:{}]","comment":"buildkit.dockerfile.v0","empty_layer":true},{"created":"2025-05-29T16:02:07Z","created_by":"CMD [\"redis-server\"]","comment":"buildkit.dockerfile.v0","empty_layer":true}],"os":"linux","rootfs":{"type":"layers","diff_ids":["sha256:ace34d1d784c01e3f9d156687089e8f58f786e23ccd097bdbbf337d6d28b3783","sha256:eac417afb6f84c59a4d65191a614ae91a9fa5f758133895dbfc825ea105df350","sha256:f60ffc5321aebc2c2c100f36a2f272e66015c050caa3c7609c49cb77285c0b16","sha256:a0c82abe04525cf5dfe64c8280946f8732856e4cb6dc61fcd6150f52a5ba86a8","sha256:67f5c1f621468fc7dbdc50ca6143ed4874b0f840e48da566b66900e4ca829090","sha256:5f70bf18a086007016e948b04aed3b82103a36bea41755b6cddfaf10ace3c6ef","sha256:cc95c0d46b8298cac56067ce16d32f1fd7cbecc1b1b0d6b2340743bc6bf5da18"]}}